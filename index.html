<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OrigamiTube</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:Arial,sans-serif; background:#f9f9f9;}
header { display:flex; align-items:center; padding:12px 16px; font-size:20px; font-weight:bold; border-bottom:1px solid #ddd; gap:12px;}
header input { flex:1; padding:8px 12px; border-radius:20px; border:1px solid #ccc; font-size:14px;}
main { padding:16px; display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:16px;}
.video-card { cursor:pointer;}
.thumb { width:100%; aspect-ratio:16/9; border-radius:12px;}
.meta { display:flex; gap:10px; margin-top:8px;}
.avatar { width:36px; height:36px; border-radius:50%;}
h3 { margin:0; font-size:15px;}
p { margin:4px 0 0; color:#606060; font-size:13px;}
button { border:none; padding:6px 12px; border-radius:16px; cursor:pointer;}
.sub { background:black; color:white;}
.unsub { background:#eee;}
#player-page, #channel-page { display:none; padding:16px;}
iframe { width:100%; max-width:900px; aspect-ratio:16/9; border:none; border-radius:12px;}
.back { cursor:pointer; color:blue; margin-bottom:10px;}
#admin-add { position:fixed; bottom:20px; right:20px; font-size:24px; width:50px; height:50px; border-radius:50%; background:#0f0f0f; color:white; border:none; display:none; cursor:pointer;}
</style>
</head>
<body>

<header>
<span onclick="goHome()" style="cursor:pointer;">OrigamiTube</span>
<input id="search" type="text" placeholder="Search" oninput="searchVideos()">
</header>

<main id="home"></main>

<div id="player-page">
  <div class="back" onclick="goHome()">⬅ Back</div>
  <h2 id="video-title"></h2>
  <iframe id="player" allowfullscreen></iframe>
</div>

<div id="channel-page">
  <div class="back" onclick="goHome()">⬅ Back</div>
  <h2 id="channel-name"></h2>
  <button id="sub-btn"></button>
  <div id="channel-videos" style="margin-top:16px; display:grid; gap:16px;"></div>
</div>

<button id="admin-add" onclick="adminAddVideo()">+</button>

<script>
const isAdmin = true;
if(isAdmin) document.getElementById('admin-add').style.display='block';

let videos = JSON.parse(localStorage.getItem('videos') || '[]');
let subs = JSON.parse(localStorage.getItem('subs') || '{}');

function saveVideos(){ localStorage.setItem('videos', JSON.stringify(videos)); }
function saveSubs(){ localStorage.setItem('subs', JSON.stringify(subs)); }

// Autocomplete dropdown
const searchInput=document.getElementById('search');
const dropdown=document.createElement('div');
dropdown.style.position='absolute';
dropdown.style.background='white';
dropdown.style.border='1px solid #ccc';
dropdown.style.borderRadius='6px';
dropdown.style.top='52px';
dropdown.style.left='16px';
dropdown.style.width='calc(100% - 32px)';
dropdown.style.maxHeight='200px';
dropdown.style.overflowY='auto';
dropdown.style.zIndex='999';
dropdown.style.display='none';
document.body.appendChild(dropdown);

searchInput.addEventListener('input',()=>{
  const q=searchInput.value.toLowerCase();
  dropdown.innerHTML='';
  if(!q){ dropdown.style.display='none'; renderHome(); return;}
  const results=videos.filter(v=>v.title.toLowerCase().includes(q)||v.channel.toLowerCase().includes(q));
  results.forEach(v=>{
    const div=document.createElement('div');
    div.innerText=v.title+' - '+v.channel;
    div.style.padding='6px 12px';
    div.style.cursor='pointer';
    div.addEventListener('click',()=>{ playVideo(v.videoId,v.title); dropdown.style.display='none'; searchInput.value=''; });
    div.addEventListener('mouseover',()=>div.style.background='#f0f0f0');
    div.addEventListener('mouseout',()=>div.style.background='white');
    dropdown.appendChild(div);
  });
  dropdown.style.display=results.length?'block':'none';
});

function renderHome() {
  home.style.display='grid';
  playerPage.style.display='none';
  channelPage.style.display='none';
  home.innerHTML='';
  videos.forEach(v=>{
    home.innerHTML += `
    <div class="video-card">
      <img class="thumb" src="https://img.youtube.com/vi/${v.videoId}/hqdefault.jpg" onclick="playVideo('${v.videoId}','${v.title}')">
      <div class="meta">
        <img class="avatar" src="${v.avatar}" onclick="openChannel('${v.channel}')">
        <div>
          <h3>${v.title}</h3>
          <p onclick="openChannel('${v.channel}')">${v.channel}</p>
        </div>
      </div>
    </div>`;
  });
}

function playVideo(id,title){
  home.style.display='none';
  channelPage.style.display='none';
  playerPage.style.display='block';
  videoTitle.innerText=title;
  player.src=`https://www.youtube.com/embed/${id}?autoplay=1&controls=1`;
}

function goHome(){ player.src=''; renderHome(); }

function openChannel(name){
  home.style.display='none';
  playerPage.style.display='none';
  channelPage.style.display='block';
  channelName.innerText=name;
  updateSubButton(name);
  channelVideos.innerHTML='';
  videos.filter(v=>v.channel===name).forEach(v=>{
    channelVideos.innerHTML+=`
      <div onclick="playVideo('${v.videoId}','${v.title}')">
        <img class="thumb" src="https://img.youtube.com/vi/${v.videoId}/hqdefault.jpg">
        <h3>${v.title}</h3>
      </div>`;
  });
}

function updateSubButton(name){
  const btn=subBtn;
  const isSub=subs[name];
  btn.className=isSub?'unsub':'sub';
  btn.innerText=isSub?'Subscribed':'Subscribe';
  btn.onclick=()=>{
    subs[name]=!subs[name];
    saveSubs();
    updateSubButton(name);
  };
}

function adminAddVideo(){
  const title=prompt("Video title:");
  if(!title) return;
  const channel=prompt("Channel name:");
  if(!channel) return;
  const avatar=prompt("Avatar image URL (36x36):")||'https://via.placeholder.com/36';
  const videoId=prompt("YouTube video ID (letters/numbers only):");
  if(!videoId) return;
  videos.push({title,channel,avatar,videoId});
  saveVideos();
  renderHome();
}

const home=document.getElementById('home');
const playerPage=document.getElementById('player-page');
const channelPage=document.getElementById('channel-page');
const videoTitle=document.getElementById('video-title');
const player=document.getElementById('player');
const channelName=document.getElementById('channel-name');
const channelVideos=document.getElementById('channel-videos');
const subBtn=document.getElementById('sub-btn');

if(videos.length===0){
  videos.push({title:"How To Fold An Origami Dragon",channel:"Art for Kids Hub",avatar:"https://yt3.ggpht.com/ytc/AKedOLS7",videoId:"UEuw2G5usMA"});
  videos.push({title:"How To Fold An Origami Snapper Puppet",channel:"Art for Kids Hub",avatar:"https://yt3.ggpht.com/ytc/AKedOLS7",videoId:"ybKPN9vNlHc"});
  videos.push({title:"How To Fold Paper Claws",channel:"Art for Kids Hub",avatar:"https://yt3.ggpht.com/ytc/AKedOLS7",videoId:"OiiQ0wGI004"});
  saveVideos();
}

renderHome();
</script>
